#!/bin/bash

# I run this script every minute via cron

databaseName=("Database.kdbx" "TOTF.kdbx" "Recovery.kdbx")
keepassDirectory="/home/jp/synced/keepass"
passUsbDirectory="/media/Mijn bestanden"

if mount | grep -q " on $passUsbDirectory "
then
    # do it for all the databases
    for database in ${databaseName[@]};
    do
        if [[ $(diff "$keepassDirectory/$database" "$passUsbDirectory/$database") != ""  ]]
        then
            notify-send "Pass Usb Rsync, Changes!" "Updating Password Database: $database on USB"

            rsync "$keepassDirectory/$database" "$passUsbDirectory/$database"

        # else
        #     notify-send "Same binary" "Not necessary to update Password-Database: $database on USB"

        fi
    done
fi
